labels:
  platform: linux/amd64
when:
  event: [push, pull_request, tag]
steps:
  - name: build
    image: repo.osgeo.org/postgis/build-test:trisquel3
    when:
      path: 
        include: ['doc/*', '.woodpecker/*.yaml']
    commands:
      - export PATH=/usr/lib/postgresql/12/bin:$PATH
      - ./autogen.sh
      - PGVER=12 ./configure
      - make docs
      - make -C doc check
      - make docs-localized
      - make -C doc/ check-localized
